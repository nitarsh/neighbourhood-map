<!DOCTYPE html>
<html>

<head>
    <title>Shrinath's Neighbourhood map</title>

    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script type='text/javascript' src='js/knockout-3.4.2.js'></script>
</head>

<body>
    <header>
        <h1>Shrinath's Neighbourhood map</h1>
    </header>
    <div id="main-content">
        <div id="map"></div>
        <div id="loc-list-container">
            <input type="text" placeholder="Filter locations">

            <ul id="loc-list" data-bind="foreach: obsLocations">
                <li>
                    <span data-bind="text: title"> </span>
                </li>
            </ul>
        </div>
    </div>

    <script>
        function makeMarkerIcon(markerColor) {
            var markerImage = new google.maps.MarkerImage(
                'http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|' + markerColor +
                '|40|_|%E2%80%A2',
                new google.maps.Size(21, 34),
                new google.maps.Point(0, 0),
                new google.maps.Point(10, 34),
                new google.maps.Size(21, 34));
            return markerImage;
        }

        function initMap() {
            // TODO: use a constructor to create a new map JS object. You can use the coordinates
            // 18.546540,73.903070
            // 18.553104, 73.903938
            var k_nagar = {
                lat: 18.546540,
                lng: 73.903070
            };

            var styles = [{
                "featureType": "administrative",
                "elementType": "labels.text.fill",
                "stylers": [{
                    "color": "#444444"
                }]
            }, {
                "featureType": "landscape",
                "elementType": "all",
                "stylers": [{
                    "color": "#f2f2f2"
                }]
            }, {
                "featureType": "poi",
                "elementType": "all",
                "stylers": [{
                    "visibility": "off"
                }]
            }, {
                "featureType": "road",
                "elementType": "all",
                "stylers": [{
                    "saturation": -100
                }, {
                    "lightness": 45
                }]
            }, {
                "featureType": "road.highway",
                "elementType": "all",
                "stylers": [{
                    "visibility": "simplified"
                }]
            }, {
                "featureType": "road.arterial",
                "elementType": "labels.icon",
                "stylers": [{
                    "visibility": "off"
                }]
            }, {
                "featureType": "transit",
                "elementType": "all",
                "stylers": [{
                    "visibility": "off"
                }]
            }, {
                "featureType": "water",
                "elementType": "all",
                "stylers": [{
                    "color": "#46bcec"
                }, {
                    "visibility": "on"
                }]
            }];

            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 14,
                center: k_nagar,
                styles: styles
            });

            var locations = [{
                title: 'The Westin',
                location: {
                    lat: 18.5396281,
                    lng: 73.907227
                }
            }, {
                title: 'German Bakery',
                location: {
                    lat: 18.542583,
                    lng: 73.8877385
                }
            }, {
                title: 'Hyatt Pune',
                location: {
                    lat: 18.553104,
                    lng: 73.903938
                }
            }, {
                title: 'Cybage Software',
                location: {
                    lat: 18.546228,
                    lng: 73.910933
                }
            }, {
                title: 'Aga Khan Palace',
                location: {
                    lat: 18.552006,
                    lng: 73.900204
                }

            }];

            // var obsLocations = ko.observableArray();
            //
            // ko.applyBindings(locations);

            var defaultIcon = makeMarkerIcon('11E165');
            var highlightedIcon = makeMarkerIcon('FF9013');

            for (var i = 0; i < locations.length; i++) {
                // Get the position from the location array.
                var position = locations[i].location;
                var title = locations[i].title;
                // Create a marker per location, and put into markers array.
                var marker = new google.maps.Marker({
                    position: position,
                    title: title,
                    animation: google.maps.Animation.DROP,
                    icon: defaultIcon,
                    id: i,
                    map: map
                });

                // addToDisplay(locationList, title);
                // Push the marker to our array of markers.
                // markers.push(marker);
                // Create an onclick event to open the large infowindow at each marker.
                // marker.addListener('click', function() {
                //   populateInfoWindow(this, largeInfowindow);
                // });
                // // Two event listeners - one for mouseover, one for mouseout,
                // // to change the colors back and forth.
                marker.addListener('mouseover', function() {
                    this.setIcon(highlightedIcon);
                });
                marker.addListener('mouseout', function() {
                    this.setIcon(defaultIcon);
                });
            }
        }
    </script>
    <!--TODO: Load the JS API ASYNCHRONOUSLY below.-->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyOG34X2U6iKWgvwGmukiaBaVr3-PkNs4&callback=initMap">
    </script>

    <script async defer src="js/locationsVM.js">
    </script>
</body>
